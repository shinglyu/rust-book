<!DOCTYPE HTML>
<html lang="zh-Hant">
    <head>
        <meta charset="UTF-8">
        <title>Rust ç¨‹å¼èªè¨€ æ­£é«”ä¸­æ–‡ç‰ˆ</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="The Rust Programming Language">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="">

		<style>
            @import url(http://fonts.googleapis.com/earlyaccess/cwtexhei.css);
        </style>
        <link rel="stylesheet" href="book.css">
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">

        <!-- MathJax -->
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>
    </head>
    <body>
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = localStorage.getItem('theme');
            if (theme == null) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = localStorage.getItem('sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li><a href="README.html"><strong>1.</strong> ç°¡ä»‹</a></li><li><a href="getting-started.html"><strong>2.</strong> æº–å‚™</a></li><li><a href="guessing-game.html" class="active"><strong>3.</strong> æ•™å­¸: çŒœæ•¸å­—éŠæˆ²</a></li><li><a href="syntax-and-semantics.html"><strong>4.</strong> èªæ³•åŠèªæ„</a></li><li><ul class="section"><li><a href="variable-bindings.html"><strong>4.1.</strong> è®Šæ•¸ç¶å®š</a></li><li><a href="functions.html"><strong>4.2.</strong> å‡½å¼</a></li><li><a href="primitive-types.html"><strong>4.3.</strong> åŸºæœ¬å‹åˆ¥</a></li><li><a href="comments.html"><strong>4.4.</strong> è¨»è§£</a></li><li><a href="if.html"><strong>4.5.</strong> if</a></li><li><a href="loops.html"><strong>4.6.</strong> è¿´åœˆ</a></li><li><a href="ownership.html"><strong>4.7.</strong> æ‰€æœ‰æ¬Š</a></li><li><a href="references-and-borrowing.html"><strong>4.8.</strong> åƒç…§èˆ‡å€Ÿç”¨</a></li><li><a href="lifetimes.html"><strong>4.9.</strong> ç”Ÿå‘½é€±æœŸ</a></li><li><a href="mutability.html"><strong>4.10.</strong> å¯è®Šæ€§</a></li><li><a href="structs.html"><strong>4.11.</strong> çµæ§‹é«”</a></li><li><a href="enums.html"><strong>4.12.</strong> æšèˆ‰</a></li><li><a href="match.html"><strong>4.13.</strong> Match</a></li><li><a href="patterns.html"><strong>4.14.</strong> æ¨¡å¼</a></li><li><a href="method-syntax.html"><strong>4.15.</strong> Method Syntax</a></li><li><a href="vectors.html"><strong>4.16.</strong> Vectors</a></li><li><a href="strings.html"><strong>4.17.</strong> Strings</a></li><li><a href="generics.html"><strong>4.18.</strong> Generics</a></li><li><a href="traits.html"><strong>4.19.</strong> Traits</a></li><li><a href="drop.html"><strong>4.20.</strong> Drop</a></li><li><a href="if-let.html"><strong>4.21.</strong> if let</a></li><li><a href="trait-objects.html"><strong>4.22.</strong> Trait Objects</a></li><li><a href="closures.html"><strong>4.23.</strong> Closures</a></li><li><a href="ufcs.html"><strong>4.24.</strong> Universal Function Call Syntax</a></li><li><a href="crates-and-modules.html"><strong>4.25.</strong> Crates and Modules</a></li><li><a href="const-and-static.html"><strong>4.26.</strong> <code>const</code> and <code>static</code></a></li><li><a href="attributes.html"><strong>4.27.</strong> Attributes</a></li><li><a href="type-aliases.html"><strong>4.28.</strong> <code>type</code> aliases</a></li><li><a href="casting-between-types.html"><strong>4.29.</strong> Casting between types</a></li><li><a href="associated-types.html"><strong>4.30.</strong> Associated Types</a></li><li><a href="unsized-types.html"><strong>4.31.</strong> Unsized Types</a></li><li><a href="operators-and-overloading.html"><strong>4.32.</strong> Operators and Overloading</a></li><li><a href="deref-coercions.html"><strong>4.33.</strong> Deref coercions</a></li><li><a href="macros.html"><strong>4.34.</strong> Macros</a></li><li><a href="raw-pointers.html"><strong>4.35.</strong> Raw Pointers</a></li><li><a href="unsafe.html"><strong>4.36.</strong> <code>unsafe</code></a></li></ul></li><li><a href="effective-rust.html"><strong>5.</strong> Effective Rust</a></li><li><ul class="section"><li><a href="the-stack-and-the-heap.html"><strong>5.1.</strong> The Stack and the Heap</a></li><li><a href="testing.html"><strong>5.2.</strong> Testing</a></li><li><a href="conditional-compilation.html"><strong>5.3.</strong> Conditional Compilation</a></li><li><a href="documentation.html"><strong>5.4.</strong> Documentation</a></li><li><a href="iterators.html"><strong>5.5.</strong> Iterators</a></li><li><a href="concurrency.html"><strong>5.6.</strong> Concurrency</a></li><li><a href="error-handling.html"><strong>5.7.</strong> Error Handling</a></li><li><a href="choosing-your-guarantees.html"><strong>5.8.</strong> Choosing your Guarantees</a></li><li><a href="ffi.html"><strong>5.9.</strong> FFI</a></li><li><a href="borrow-and-asref.html"><strong>5.10.</strong> Borrow and AsRef</a></li><li><a href="release-channels.html"><strong>5.11.</strong> Release Channels</a></li><li><a href="using-rust-without-the-standard-library.html"><strong>5.12.</strong> Using Rust without the standard library</a></li></ul></li><li><a href="nightly-rust.html"><strong>6.</strong> Nightly Rust</a></li><li><ul class="section"><li><a href="compiler-plugins.html"><strong>6.1.</strong> Compiler Plugins</a></li><li><a href="inline-assembly.html"><strong>6.2.</strong> Inline Assembly</a></li><li><a href="no-stdlib.html"><strong>6.3.</strong> No stdlib</a></li><li><a href="intrinsics.html"><strong>6.4.</strong> Intrinsics</a></li><li><a href="lang-items.html"><strong>6.5.</strong> Lang items</a></li><li><a href="advanced-linking.html"><strong>6.6.</strong> Advanced linking</a></li><li><a href="benchmark-tests.html"><strong>6.7.</strong> Benchmark Tests</a></li><li><a href="box-syntax-and-patterns.html"><strong>6.8.</strong> Box Syntax and Patterns</a></li><li><a href="slice-patterns.html"><strong>6.9.</strong> Slice Patterns</a></li><li><a href="associated-constants.html"><strong>6.10.</strong> Associated Constants</a></li><li><a href="custom-allocators.html"><strong>6.11.</strong> Custom Allocators</a></li></ul></li><li><a href="glossary.html"><strong>7.</strong> è©å½™è¡¨</a></li><li><a href="syntax-index.html"><strong>8.</strong> èªæ³•ç´¢å¼•</a></li><li><a href="bibliography.html"><strong>9.</strong> åƒè€ƒæ–‡ç»</a></li><li><a href="MappingTable.html"><strong>10.</strong> ä¸­è‹±æ–‡å­—å½™å°ç…§è¡¨</a></li><li><a href="CONTRIBUTORS.html"><strong>11.</strong> ç¿»è­¯è²¢ç»åå–®</a></li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush"></i>
                    </div>

                    <h1 class="menu-title">Rust ç¨‹å¼èªè¨€ æ­£é«”ä¸­æ–‡ç‰ˆ</h1>

                    <div class="right-buttons">
                        <i id="print-button" class="fa fa-print" title="Print this book"></i>
                    </div>
                </div>

                <div id="content" class="content">
                    <h1>çŒœæ•¸å­—éŠæˆ²</h1>
<p>è®“æˆ‘å€‘é–‹å§‹å­¸ç¿’ Rust å§ï¼
ä½œç‚ºæˆ‘å€‘çš„ç¬¬ä¸€å€‹å°ˆæ¡ˆï¼Œæˆ‘å€‘æœƒå¯¦ä½œä¸€å€‹ç¶“å…¸çš„æ–°æ‰‹ç¨‹å¼å•é¡Œï¼šçŒœæ•¸å­— (guessing game)ã€‚
å®ƒçš„è¦å‰‡æ˜¯é€™æ¨£ï¼šæˆ‘å€‘çš„ç¨‹å¼æœƒç”¢ç”Ÿä¸€å€‹ 1 åˆ° 100 é–“çš„äº‚æ•¸ã€‚
ç„¶å¾Œæç¤ºæˆ‘å€‘è¼¸å…¥æ•¸å­—çŒœçŒœçœ‹ã€‚
ç•¶æˆ‘å€‘è¼¸å…¥ä¹‹å¾Œï¼Œå®ƒæœƒå‘Šè¨´æˆ‘å€‘å¤ªå¤§é‚„æ˜¯å¤ªå°ã€‚
ç•¶æˆ‘å€‘çŒœå°äº†ï¼Œå®ƒæœƒæ­å–œæˆ‘å€‘ã€‚
è½èµ·ä¾†ä¸éŒ¯å§ï¼Ÿ</p>
<p>æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘å°‡æœƒå­¸åˆ°ä¸€äº› Rust çš„æ±è¥¿ã€‚
ä¸‹ä¸€ç«  &quot;èªæ³•åŠèªæ„&quot; å°‡æœƒæ›´æ·±å…¥æ¢ç©¶æ¯ä¸€éƒ¨ä»½ã€‚</p>
<h2>æº–å‚™</h2>
<p>è®“æˆ‘å€‘æº–å‚™ä¸€å€‹æ–°å°ˆæ¡ˆã€‚
é€²åˆ°ä½ çš„å°ˆæ¡ˆç›®éŒ„ã€‚
é‚„è¨˜å¾—æˆ‘å€‘å¦‚ä½•æ›¿ <code>hello_world</code> å»ºç«‹ç›®éŒ„çµæ§‹å’Œ <code>Cargo.toml</code> å—ï¼Ÿ
Cargo æœ‰å€‹èƒ½å¹«æˆ‘å€‘åšå¥½é€™äº›äº‹æƒ…çš„æŒ‡ä»¤ã€‚
è®“æˆ‘å€‘è©¦è©¦çœ‹ï¼š</p>
<pre><code class="language-bash">$ cd ~/projects
$ cargo new guessing_game --bin
$ cd guessing_game
</code></pre>
<p>æˆ‘å€‘å‚³éå°ˆæ¡ˆçš„åå­—çµ¦ <code>cargo new</code>ï¼Œæ¥è‘—æ˜¯ <code>--bin</code> çš„åƒæ•¸ï¼Œå› ç‚ºæˆ‘å€‘è¦å»ºç«‹åŸ·è¡Œæª”è€Œä¸æ˜¯å‡½å¼åº«ã€‚</p>
<p>çœ‹çœ‹ç”¢ç”Ÿçš„ <code>Cargo.toml</code>ï¼š</p>
<pre><code class="language-toml">[package]

name = &quot;guessing_game&quot;
version = &quot;0.1.0&quot;
authors = [&quot;Your Name &lt;you@example.com&gt;&quot;]
</code></pre>
<p>Cargo æœƒå¾ä½ çš„ç’°å¢ƒè¨­å®šä¸­å–å¾—é€™äº›è³‡è¨Šã€‚
å¦‚æœå®ƒä¸æ­£ç¢ºï¼Œå°±ç›´æ¥ä¿®æ”¹å§ã€‚</p>
<p>æœ€å¾Œï¼ŒCargo å¹«æˆ‘å€‘ç”¢ç”Ÿäº†ä¸€å€‹ &quot;Hello, world!&quot;ã€‚
çœ‹çœ‹ <code>src/main.rs</code> æª”æ¡ˆï¼š</p>
<pre><code class="language-rust">fn main() {
    println!(&quot;Hello, world!&quot;);
}
</code></pre>
<p>è®“æˆ‘å€‘è©¦è‘—ç·¨è­¯ï¼š</p>
<pre><code class="language-{bash}">$ cargo build
   Compiling guessing_game v0.1.0 (file:///home/you/projects/guessing_game)
</code></pre>
<p>å¤ªæ£’äº†ï¼
å†æ¬¡æ‰“é–‹ä½ çš„ <code>src/main.rs</code>ã€‚
æˆ‘å€‘å°‡é–‹å§‹åœ¨é€™å€‹æª”æ¡ˆå¯«å…¥æˆ‘å€‘æ‰€æœ‰çš„ç¨‹å¼ç¢¼ã€‚</p>
<p>åœ¨ç¹¼çºŒä¹‹å‰ï¼Œè®“æˆ‘å€‘å‘Šè¨´ä½ å¦ä¸€å€‹ Cargo çš„æŒ‡ä»¤ <code>run</code>ã€‚
<code>cargo run</code> æœ‰é»é¡ä¼¼ <code>cargo build</code>ï¼Œä½†æ˜¯ä»–åŒæ™‚æœƒåŸ·è¡Œç”¢ç”Ÿçš„åŸ·è¡Œæª”ã€‚
è©¦è©¦çœ‹ï¼š</p>
<pre><code class="language-bash">$ cargo run
   Compiling guessing_game v0.1.0 (file:///home/you/projects/guessing_game)
     Running `target/debug/guessing_game`
Hello, world!
</code></pre>
<p>å¾ˆå¥½ï¼
ç•¶æˆ‘å€‘éœ€è¦å¿«é€Ÿåœ°é‡è¤‡åŸ·è¡Œå°ˆæ¡ˆæ™‚ <code>run</code> æŒ‡ä»¤å¾ˆæ–¹ä¾¿ã€‚
æˆ‘å€‘çš„éŠæˆ²å°±æ˜¯ä¸€å€‹å°ˆæ¡ˆï¼Œæˆ‘å€‘éœ€è¦åœ¨æ¯å€‹é–‹ç™¼å¾ªç’° (iteration) åšå¿«é€Ÿçš„æ¸¬è©¦ä¹‹å¾Œï¼Œæ‰é€²å…¥ä¸‹ä¸€å€‹é–‹ç™¼å¾ªç’°ã€‚</p>
<h2>è™•ç†çŒœæ¸¬</h2>
<p>è®“æˆ‘å€‘é–‹å§‹å§ï¼
æˆ‘å€‘æ‰€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æƒ…æ˜¯è®“æˆ‘å€‘çš„ç©å®¶å¯ä»¥è¼¸å…¥ä»–çš„çŒœæ¸¬ã€‚
æŠŠä»¥ä¸‹å…§å®¹æ”¾å…¥ä½ çš„ <code>src/main.rs</code>ï¼š</p>
<pre><code class="language-rust,no_run">use std::io;

fn main() {
    println!(&quot;Guess the number!&quot;);

    println!(&quot;Please input your guess.&quot;);

    let mut guess = String::new();

    io::stdin().read_line(&amp;mut guess)
        .expect(&quot;Failed to read line&quot;);

    println!(&quot;You guessed: {}&quot;, guess);
}
</code></pre>
<p>æ±è¥¿æœ‰é»å¤šï¼
è®“æˆ‘å€‘ä¸€å€‹ä¸€å€‹ä¾†ã€‚</p>
<pre><code class="language-rust,ignore">use std::io;
</code></pre>
<p>æˆ‘å€‘éœ€è¦å–å¾—ä½¿ç”¨è€…çš„è¼¸å…¥ï¼Œç„¶å¾Œå°å‡ºçµæœä½œç‚ºè¼¸å‡ºã€‚
å› æ­¤ï¼Œæˆ‘å€‘éœ€è¦æ¨™æº–å‡½å¼åº«ä¸­çš„ <code>io</code> å‡½å¼åº«ã€‚
Rust é è¨­åªæœƒæ›¿æ‰€æœ‰ç¨‹å¼ import å¾ˆå°‘çš„æ±è¥¿ï¼Œ<a href="https://doc.rust-lang.org/std/prelude/index.html">prelude</a>ã€‚
å¦‚æœæœ‰æ±è¥¿ä¸åœ¨å…¶ä¸­ï¼Œä½ å°±å¿…é ˆç›´æ¥ <code>use</code> å®ƒã€‚
é€™é‚Šé‚„æœ‰ç¬¬äºŒç¨® &quot;prelude&quot;ï¼Œå«åš <a href="https://doc.rust-lang.org/std/io/prelude/index.html">io prelude</a>ï¼Œå®ƒæä¾›é¡ä¼¼çš„åŠŸèƒ½ï¼šimport å®ƒï¼Œç„¶å¾Œå®ƒå¹«ä½  import ä¸€äº›æœ‰ç”¨ä¸”è·Ÿ <code>io</code> æœ‰é—œçš„æ±è¥¿ã€‚</p>
<pre><code class="language-rust,ignore">fn main() {
</code></pre>
<p>å¦‚ä½ ä¹‹å‰æ‰€çœ‹éçš„ï¼Œ<code>main()</code> å‡½å¼æ˜¯ä½ ç¨‹å¼çš„é€²å…¥é»ã€‚
<code>fn</code> èªæ³•å®£å‘Šä¸€å€‹æ–°å‡½å¼ï¼Œ<code>()</code> èªªæ˜é€™è£¡æ²’æœ‰è¦å‚³å…¥çš„åƒæ•¸ï¼Œè€Œ <code>{</code> å¾Œé¢é–‹å§‹å‡½å¼çš„å…§å®¹ã€‚
å› ç‚ºæ²’æœ‰æåˆ°å›å‚³å‹åˆ¥ï¼Œæ‰€ä»¥é€™è£¡æœƒæ˜¯ <code>()</code>ï¼Œä¸€å€‹ç©ºçš„<a href="primitive-types.html#%E5%A4%9A%E5%85%83%E7%B5%84%20(Tuples)">å¤šå…ƒçµ„</a> (tuple)ã€‚</p>
<pre><code class="language-rust,ignore">    println!(&quot;Guess the number!&quot;);

    println!(&quot;Please input your guess.&quot;);
</code></pre>
<p>æˆ‘å€‘ä¹‹å‰å­¸åˆ° <code>println!()</code> æ˜¯å€‹å°‡<a href="strings.html">å­—ä¸²</a>å°åˆ°è¢å¹•çš„<a href="macros.html">å·¨é›†</a>ã€‚</p>
<pre><code class="language-rust,ignore">    let mut guess = String::new();
</code></pre>
<p>ç¾åœ¨é‡åˆ°æœ‰è¶£çš„æ±è¥¿äº†ï¼
é€™ä¸€è¡Œæœ‰ä¸å°‘æ±è¥¿ã€‚
ç¬¬ä¸€å€‹ï¼Œè«‹æ³¨æ„æœ‰ä¸€å€‹ <a href="variable-bindings.html">let é™³è¿°å¼</a>ï¼Œå®ƒè¢«ç”¨ä¾†å»ºç«‹ &quot;è®Šæ•¸ç¶å®š&quot;ã€‚
å®ƒçš„å½¢å¼æ˜¯ï¼š</p>
<pre><code class="language-rust,ignore">let foo = bar;
</code></pre>
<p>é€™å°‡æœƒå»ºç«‹ä¸€å€‹å«åš <code>foo</code> çš„æ–°ç¶å®šï¼Œç„¶å¾ŒæŠŠå®ƒç¶å®šåœ¨ <code>bar</code> çš„å€¼ä¸Šã€‚
åœ¨è¨±å¤šèªè¨€ä¸­ï¼Œé€™å«åš &quot;è®Šæ•¸&quot; (variable)ï¼Œä½†æ˜¯ Rust çš„è®Šæ•¸ç¶å®šæš—è—ç„æ©Ÿã€‚</p>
<p>èˆ‰ä¾‹ä¾†èªªï¼Œå®ƒé è¨­æ˜¯<a href="mutability.html">ä¸å¯è®Šçš„</a> (immutable)ã€‚
é€™ä¹Ÿæ˜¯ç‚ºä½•æˆ‘å€‘çš„ç¯„ä¾‹ä½¿ç”¨ <code>mut</code>ï¼šå®ƒä½¿ç¶å®šè®Šæˆå¯è®Šçš„ (mutable)ï¼Œè€Œä¸å†æ˜¯ä¸å¯è®Šçš„ã€‚
<code>let</code> ä¸æœƒå¾å·¦é‚Šå–å¾—è³¦å€¼ (assignment) çš„åå­—ï¼Œå¯¦éš›ä¸Šä»–ä½¿ç”¨ &quot;<a href="patterns.html">æ¨¡å¼</a>&quot; (pattern)ã€‚
æˆ‘å€‘åœ¨å¾Œé¢æœƒä½¿ç”¨æ¨¡å¼ã€‚
ç¾åœ¨å®ƒå·²ç¶“å¤ è®“æˆ‘å€‘ç°¡å–®ä½¿ç”¨äº†ï¼š</p>
<pre><code class="language-rust">let foo = 5; // immutable.
let mut bar = 5; // mutable
</code></pre>
<p>å™¢ï¼Œé‚„æœ‰ <code>//</code> æœƒé–‹å§‹ä¸€æ®µè¨»è§£ï¼Œç›´åˆ°è¡Œæœ«ã€‚
Rust æœƒå¿½ç•¥æ‰€æœ‰<a href="comments.html">è¨»è§£</a> (comment) å…§çš„æ±è¥¿ã€‚</p>
<p>æ‰€ä»¥ç¾åœ¨æˆ‘å€‘çŸ¥é“ <code>let mut guess</code> æœƒå®£å‘Šä¸€å€‹åç‚º <code>guess</code> çš„å¯è®Šè®Šæ•¸ç¶å®šï¼Œä½†æˆ‘å€‘ä»å¿…é ˆçœ‹çœ‹ <code>=</code> å¦ä¸€é‚Šç¶å®šçš„æ±è¥¿ï¼š<code>String::new()</code>ã€‚</p>
<p><code>String</code> æ˜¯ä¸€å€‹å­—ä¸²å‹åˆ¥ï¼Œç”±æ¨™æº–å‡½å¼åº«æä¾›ã€‚
ä¸€å€‹<a href="https://doc.rust-lang.org/std/string/struct.String.html">å­—ä¸²</a>æ˜¯ä¸€å€‹ä»¥ UTF-8 ç·¨ç¢¼çš„å¯è®Šé•·åº¦çš„æ–‡å­—ã€‚</p>
<p>è€Œ <code>::new()</code> èªæ³•ä½¿ç”¨ <code>::</code> æ˜¯å› ç‚ºå®ƒæ˜¯ä¸€å€‹ç‰¹å®šå‹åˆ¥çš„ &quot;é—œè¯å‡½å¼&quot; (associated function)ã€‚
ä¹Ÿå°±æ˜¯èªªï¼Œå®ƒè¢«é—œè¯åˆ° <code>String</code> æœ¬èº«ï¼Œè€Œéç‰¹å®šçš„æŸå€‹ <code>String</code> çš„å¯¦é«” (instance)ã€‚
ä¸€äº›èªè¨€ç¨±ä¹‹ç‚º &quot;éœæ…‹æ–¹æ³•&quot; (static method)ã€‚</p>
<p>æ­¤å‡½å¼è¢«ç¨±ç‚º <code>new()</code>ï¼Œå› ç‚ºå®ƒå»ºç«‹ä¸€å€‹æ–°çš„ã€ç©ºçš„ <code>String</code>ã€‚
ä½ å¯ä»¥åœ¨å…¶ä»–è¨±å¤šå‹åˆ¥æ‰¾åˆ° <code>new()</code> å‡½å¼ï¼Œå› ç‚ºå®ƒæ˜¯å»ºç«‹æŸä¸€äº›å‹åˆ¥æ–°å€¼çš„é€šç”¨åç¨±ã€‚</p>
<p>è®“æˆ‘å€‘ç¹¼çºŒä¸‹å»ï¼š</p>
<pre><code class="language-rust,ignore">    io::stdin().read_line(&amp;mut guess)
        .expect(&quot;Failed to read line&quot;);
</code></pre>
<p>ç¨å¾®æœ‰é»å¤šäº†ï¼
ä¸€æ­¥ä¸€æ­¥ä¾†ã€‚
ç¬¬ä¸€è¡Œæœ‰å…©å€‹éƒ¨åˆ†ã€‚
ç¬¬ä¸€éƒ¨åˆ†æ˜¯ï¼š</p>
<pre><code class="language-rust,ignore">io::stdin()
</code></pre>
<p>é‚„è¨˜å¾—åœ¨ç¨‹å¼ç¬¬ä¸€è¡Œæˆ‘å€‘æ€éº¼ <code>use</code> é‚£å€‹ <code>std::io</code> çš„å—ï¼Ÿ
æˆ‘å€‘ç¾åœ¨æ­£åœ¨å‘¼å«å®ƒçš„é—œè¯å‡½å¼ã€‚
å¦‚æœæˆ‘å€‘æ²’æœ‰ <code>use std::io</code>ï¼Œæˆ‘å€‘å¿…é ˆæŠŠé€™è¡Œæ”¹æˆ <code>std::io::stdin()</code>ã€‚</p>
<p>é€™å€‹ç‰¹æ®Šçš„å‡½å¼æœƒå›å‚³ä¸€å€‹ä½ çš„çµ‚ç«¯æ©Ÿæ¨™æº–è¼¸å…¥çš„æ§åˆ¶ä»£ç¢¼ (handle)ã€‚
æ›´å…·é«”çš„å…§å®¹ï¼Œå¯ä»¥åƒè€ƒ <a href="https://doc.rust-lang.org/std/io/struct.Stdin.html">std::io::Stdin</a>ã€‚</p>
<p>ä¸‹ä¸€éƒ¨ä»½å°‡æœƒä½¿ç”¨é€™å€‹æ§åˆ¶ä»£ç¢¼ (handle) ä¾†å–å¾—ä½¿ç”¨è€…çš„è¼¸å…¥ï¼š</p>
<pre><code class="language-rust,ignore">.read_line(&amp;mut guess)
</code></pre>
<p>æ­¤è™•ï¼Œæˆ‘å€‘å‘¼å«æ§åˆ¶ä»£ç¢¼ (handle) çš„ <a href="https://doc.rust-lang.org/std/io/struct.Stdin.html#method.read_line">read_line()</a> æ–¹æ³•ã€‚
<a href="method-syntax.html">æ–¹æ³•</a> (method) è·Ÿé—œè¯å‡½å¼å¾ˆé¡ä¼¼ï¼Œä½†æ˜¯åªèƒ½åœ¨ç‰¹å®šå‹åˆ¥çš„å¯¦é«” (instance) ä¸­å–ç”¨ï¼Œè€Œä¸æ˜¯å¾å‹åˆ¥æœ¬èº«å–ç”¨ã€‚
æˆ‘å€‘ä¹Ÿæœƒå‚³éä¸€å€‹åƒæ•¸çµ¦ <code>read_line()</code>ï¼š<code>&amp;mut guess</code>ã€‚</p>
<p>é‚„è¨˜å¾—å‰é¢æˆ‘å€‘å¦‚ä½•ç¶å®š <code>guess</code> å—ï¼Ÿ
æˆ‘å€‘æåˆ°å®ƒæ˜¯å¯è®Šçš„ã€‚
ç„¶è€Œï¼Œ<code>read_line</code> ä¸æ¥å—æŠŠ <code>String</code> ç•¶ä½œåƒæ•¸ï¼šå®ƒåªæ¥å— <code>&amp;mut String</code>ã€‚
Rust æœ‰ä¸€å€‹å«åš<a href="references-and-borrowing.html">åƒç…§</a> (references) çš„åŠŸèƒ½ï¼Œå®ƒå…è¨±ä½ æœ‰å¤šå€‹åƒç…§æŒ‡å‘åŒä¸€å¡Šè³‡æ–™ï¼Œé€™æ¨£å¯ä»¥é™ä½è¤‡è£½çš„å‹•ä½œã€‚
åƒç…§æ˜¯å€‹è¤‡é›œçš„åŠŸèƒ½ï¼ŒRust çš„ä¸»è¦è³£é»å°±æ˜¯èƒ½å®‰å…¨ã€ç°¡å–®çš„ä½¿ç”¨åƒç…§ã€‚
ç¾åœ¨æˆ‘å€‘ä¸éœ€è¦çŸ¥é“å¤ªå¤šç´°ç¯€ã€‚
æˆ‘å€‘åªéœ€çŸ¥é“åƒç…§èˆ‡ <code>let</code> ç¶å®šé¡ä¼¼ï¼Œå®ƒé è¨­æ˜¯ä¸å¯è®Šçš„ã€‚
å› æ­¤ï¼Œæˆ‘å€‘å¿…é ˆå¯«æˆ <code>&amp;mut guess</code> è€Œä¸æ˜¯ <code>&amp;guess</code>ã€‚</p>
<p>ç‚ºä½• <code>read_line()</code> éœ€è¦å­—ä¸²çš„å¯è®Šåƒç…§ï¼Ÿ
å› ç‚ºå®ƒçš„å·¥ä½œæ˜¯å¾æ¨™æº–è¼¸å…¥å–å¾—ä½¿ç”¨è€…çš„è¼¸å…¥ï¼Œç„¶å¾Œæ”¾é€²å­—ä¸²ä¸­ã€‚
æ‰€ä»¥å®ƒå°‡å­—ä¸²ç•¶ä½œåƒæ•¸ï¼Œç”¨ä¾†æ”¾å…¥è¼¸å…¥å€¼ï¼Œæ‰€ä»¥å®ƒä¹Ÿå¿…é ˆæ˜¯å¯è®Šçš„ã€‚</p>
<p>ä½†é€™è¡Œç¨‹å¼ç¢¼é‚„æ²’çµæŸã€‚
é›–ç„¶å®ƒåªæœ‰ä¸€è¡Œï¼Œä½†å®ƒåªæ˜¯ç¨‹å¼ç¢¼çš„å–®ä¸€é‚è¼¯çš„ç¬¬ä¸€éƒ¨ä»½ã€‚</p>
<pre><code class="language-rust,ignore">        .expect(&quot;Failed to read line&quot;);
</code></pre>
<p>ç•¶æˆ‘å€‘ä½¿ç”¨ <code>.foo()</code> èªæ³•å‘¼å«æ–¹æ³•æ™‚ï¼Œä½ èƒ½ä»¥ç©ºç™½æˆ–æ˜¯é–‹æ–°çš„ä¸€è¡Œç•¶é–‹é ­ã€‚
é€™å¯ä»¥å¹«åŠ©ä½ æŠŠå¤ªé•·çš„ä¸€è¡Œç¨‹å¼ç¢¼åˆ‡æ–·ã€‚
æˆ‘å€‘ç•¶ç„¶ <em>å¯ä»¥</em> é€™æ¨£åšï¼š</p>
<pre><code class="language-rust,ignore">    io::stdin().read_line(&amp;mut guess).expect(&quot;failed to read line&quot;);
</code></pre>
<p>ä½†æ˜¯é€™æ¨£å¾ˆé›£é–±è®€ã€‚
æ‰€ä»¥æˆ‘å€‘æŠŠå®ƒæ ¹æ“šå…©å€‹æ–¹æ³•çš„å‘¼å«ä¾†åˆ‡æˆå…©è¡Œã€‚
æˆ‘å€‘å·²ç¶“èªªé <code>read_line()</code> äº†ï¼Œä½† <code>expect()</code> å‘¢ï¼Ÿ
æ©ï¼Œæˆ‘å€‘å·²ç¶“æé <code>read_line()</code> æœƒæŠŠä½¿ç”¨è€…çš„è¼¸å…¥æ”¾å…¥ <code>&amp;mut String</code> åƒæ•¸ä¸­ã€‚
ä½†å®ƒä¹Ÿæœƒå›å‚³ä¸€å€‹å€¼ï¼šåœ¨é€™è£¡æ˜¯ä¸€å€‹ <a href="https://doc.rust-lang.org/std/io/type.Result.html">io::Result</a>ã€‚
Rust çš„æ¨™æº–å‡½å¼åº«ä¸­æœ‰è¨±å¤šå«åš <code>Result</code> çš„å‹åˆ¥ï¼šä¸€èˆ¬çš„ <a href="https://doc.rust-lang.org/std/result/enum.Result.html">Result</a> èˆ‡å­å‡½å¼åº«çš„ç‰¹åˆ¥ç‰ˆæœ¬ï¼Œåƒ <code>io::Result</code>ã€‚</p>
<p>é€™ç¨® <code>Result</code> å‹åˆ¥çš„ç›®çš„æ˜¯æŠŠéŒ¯èª¤è™•ç†è¨Šæ¯ç·¨ç¢¼ã€‚
<code>Result</code> å‹åˆ¥çš„å€¼èˆ‡å…¶ä»–ä»»ä½•å‹åˆ¥ä¸€æ¨£ï¼Œæœ‰å®šç¾©å®ƒè‡ªå·±çš„æ–¹æ³•ã€‚
æ­¤è™•çš„ <code>io::Result</code> æœ‰ <a href="https://doc.rust-lang.org/std/result/enum.Result.html#method.expect">expect() æ–¹æ³•</a>ï¼Œå¯ä»¥ç”¨ä¾†å–å¾—å‘¼å«å®ƒçš„çµæœå€¼ï¼Œå¦‚æœå‘¼å«å®ƒçš„çµæœä¸æ˜¯æˆåŠŸçš„å€¼ï¼Œå°±æœƒ <a href="error-handling.html">panic!</a> ä¸”å¸¶è‘—ä½ å‚³çµ¦å®ƒçš„è¨Šæ¯ã€‚
é€™æ¨£çš„ <code>panic!</code> æœƒè®“ä½ çš„ç¨‹å¼ç•¶æ©Ÿï¼Œä¸¦é¡¯ç¤ºå‡ºä½ å‚³çµ¦å®ƒçš„è¨Šæ¯ã€‚</p>
<p>å¦‚æœæˆ‘å€‘å»æ‰é€™å€‹æ–¹æ³•çš„å‘¼å«ï¼Œæˆ‘å€‘çš„ç¨‹å¼ä»å¯ä»¥ç·¨è­¯æˆåŠŸï¼Œä½†æ˜¯æˆ‘å€‘æœƒçœ‹åˆ°è­¦å‘Šè¨Šæ¯ï¼š</p>
<pre><code class="language-bash">$ cargo build
   Compiling guessing_game v0.1.0 (file:///home/you/projects/guessing_game)
src/main.rs:10:5: 10:39 warning: unused result which must be used,
#[warn(unused_must_use)] on by default
src/main.rs:10     io::stdin().read_line(&amp;mut guess);
                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</code></pre>
<p>Rust è­¦å‘Šæˆ‘å€‘æ²’æœ‰ä½¿ç”¨ <code>Result</code> çš„å€¼ã€‚
é€™å€‹è­¦å‘Šä¾†è‡ª <code>io::Result</code> çš„ç‰¹æ®Šè¨»é‡‹ (annotation)ã€‚
Rust æœƒè©¦åœ–å‘Šè¨´ä½ ä½ æ²’æœ‰è™•ç†å¯èƒ½çš„éŒ¯èª¤ã€‚
è™•ç†éŒ¯èª¤çš„æ­£ç¢ºæ–¹å¼æ‡‰è©²æ˜¯æ’°å¯«éŒ¯èª¤è™•ç†çš„ç¨‹å¼ç¢¼ã€‚
å¹¸é‹çš„æ˜¯ï¼Œå¦‚æœæˆ‘å€‘åªæƒ³è¦ä¸€æœ‰å•é¡Œå°±ç•¶æ©Ÿï¼Œæˆ‘å€‘å¯ä»¥ç›´æ¥ä½¿ç”¨é€™å…©å€‹æ–¹æ³•ã€‚
è€Œå¦‚æœæˆ‘å€‘æƒ³å¾éŒ¯èª¤ä¸­æ¢å¾©æ­£å¸¸ï¼Œæˆ‘å€‘å¿…é ˆåšä¸€äº›å…¶ä»–çš„äº‹ï¼Œä½†æˆ‘å€‘ç•™åœ¨ä¹‹å¾Œçš„å°ˆæ¡ˆå†èªªã€‚</p>
<p>é€™å€‹ç¯„ä¾‹ç¾åœ¨åªå‰©ä¸‹ä¸€è¡Œï¼š</p>
<pre><code class="language-rust,ignore">    println!(&quot;You guessed: {}&quot;, guess);
}
</code></pre>
<p>é€™è¡Œå°å‡ºæˆ‘å€‘æ‰€å­˜çš„è¼¸å…¥å€¼ã€‚
<code>{}</code> æ˜¯å€‹ placeholderï¼Œå› æ­¤æˆ‘å€‘å‚³é <code>guess</code> ä½œç‚ºåƒæ•¸ã€‚
å¦‚æœæˆ‘å€‘æœ‰å¤šå€‹ <code>{}</code>ï¼Œæˆ‘å€‘éœ€è¦å‚³éå¤šå€‹åƒæ•¸ï¼š</p>
<pre><code class="language-rust">let x = 5;
let y = 10;

println!(&quot;x and y: {} and {}&quot;, x, y);
</code></pre>
<p>ç°¡å–®å§ã€‚</p>
<p>ç¸½ä¹‹ï¼Œé€™å°±åƒå€‹å°è¦½ã€‚
æˆ‘å€‘å¯ä»¥ç”¨ <code>cargo run</code> åŸ·è¡Œæˆ‘å€‘çš„å°ˆæ¡ˆï¼š</p>
<pre><code class="language-bash">$ cargo run
   Compiling guessing_game v0.1.0 (file:///home/you/projects/guessing_game)
     Running `target/debug/guessing_game`
Guess the number!
Please input your guess.
6
You guessed: 6
</code></pre>
<p>å¥½å§ï¼æˆ‘å€‘çš„ç¬¬ä¸€éƒ¨ä»½å®Œæˆäº†ï¼šæˆ‘å€‘å¯ä»¥å¾éµç›¤å–å¾—è¼¸å…¥å€¼ï¼Œç„¶å¾Œå°å‡ºä¾†ã€‚</p>
<h2>ç”¢ç”Ÿç¥•å¯†æ•¸å­—</h2>
<p>æ¥è‘—ï¼Œæˆ‘å€‘éœ€è¦ç”¢ç”Ÿä¸€å€‹ç¥•å¯†æ•¸å­—ã€‚
Rust çš„æ¨™æº–å‡½å¼åº«é‚„æ²’æœ‰åŒ…å«äº‚æ•¸åŠŸèƒ½ã€‚
ä½†æ˜¯ Rust åœ˜éšŠæä¾›äº† <a href="https://crates.io/crates/rand">rand crate</a>ã€‚
é€™å€‹ &quot;crate&quot; æ˜¯ä¸€åŒ… Rust ç¨‹å¼ç¢¼ã€‚
æˆ‘å€‘æœƒå»ºç½®å¯ä»¥åŸ·è¡Œçš„ &quot;binary crate&quot;ã€‚
<code>rand</code> æ˜¯å€‹ &quot;library crate&quot;ï¼ŒåŒ…å«äº†å¯ä»¥è¢«å…¶ä»–ç¨‹å¼ä½¿ç”¨çš„ç¨‹å¼ç¢¼ã€‚</p>
<p>ä½¿ç”¨å¤–éƒ¨çš„ crates æ˜¯ Cargo çš„äº®é»ã€‚
åœ¨æˆ‘å€‘ä½¿ç”¨ <code>rand</code> æ’°å¯«ç¨‹å¼ç¢¼å‰ï¼Œæˆ‘å€‘è¦ä¿®æ”¹ <code>Cargo.toml</code>ã€‚
æ‰“é–‹å®ƒï¼Œç„¶å¾ŒåŠ å…¥ä»¥ä¸‹å¹¾è¡Œï¼š</p>
<pre><code class="language-toml">[dependencies]

rand=&quot;0.3.0&quot;
</code></pre>
<p><code>Cargo.toml</code> çš„ <code>[dependencies]</code> ä¸€ç¯€è·Ÿ <code>[package]</code> é¡ä¼¼ï¼šå®ƒå¾Œé¢çš„æ‰€æœ‰æ±è¥¿éƒ½æ˜¯å®ƒçš„ä¸€éƒ¨ä»½ï¼Œç›´åˆ°ä¸‹ä¸€ç¯€çš„é–‹å§‹ç‚ºæ­¢ã€‚
Cargo ä½¿ç”¨ dependencies ä¾†ç­è§£ä½ éœ€è¦çš„å¤–éƒ¨ crates ä»¥åŠç‰ˆæœ¬ã€‚
åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œæˆ‘å€‘ç‰¹åˆ¥æŒ‡å®šç‰ˆæœ¬ <code>0.3.0</code>ï¼Œæ‰€ä»¥ Cargo ç­è§£çŸ¥é“ä»»ä½•ç™¼è¡Œç‰ˆéƒ½è¦è·Ÿé€™å€‹ç‰ˆæœ¬ç›¸å®¹ã€‚
Cargo èƒ½ç­è§£ <a href="http://semver.org">Semantic Versioning</a> çš„ç‰ˆæœ¬ç·¨ç¢¼æ–¹å¼ï¼Œé€™æ˜¯æ’°å¯«ç‰ˆæœ¬è™Ÿç¢¼çš„ä¸€ç¨®æ¨™æº–ã€‚
ä¸Šé¢çš„ç‰ˆè™Ÿå¯¦éš›ä¸Šå¯ä»¥å¯«æˆ <code>^0.3.0</code>ï¼Œä»£è¡¨ &quot;æ‰€æœ‰è·Ÿ 0.3.0 ç›¸å®¹çš„ç‰ˆæœ¬&quot;ã€‚
å¦‚æœæˆ‘å€‘æƒ³è¦ç¢ºå¯¦çš„åªç”¨ <code>0.3.0</code>ï¼Œæˆ‘å€‘å¯ä»¥å¯«æˆ <code>rand=&quot;=0.3.0&quot;</code>ï¼ˆè«‹æ³¨æ„å…©å€‹ç­‰è™Ÿï¼‰ã€‚
è€Œç•¶æˆ‘å€‘æƒ³è¦ä½¿ç”¨æœ€æ–°ç‰ˆï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ <code>*</code>ã€‚
æˆ‘å€‘ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€å€‹ç¯„åœå…§çš„ç‰ˆæœ¬ã€‚
<a href="http://doc.crates.io/crates-io.html">Cargo çš„èªªæ˜æ–‡ä»¶</a> æœ‰æ›´å¤šç´°ç¯€ã€‚</p>
<p>ç¾åœ¨ï¼Œä¸ä¿®æ”¹ä»»ä½•æˆ‘å€‘çš„ç¨‹å¼ç¢¼ï¼Œè®“æˆ‘å€‘å»ºç½®æˆ‘å€‘çš„å°ˆæ¡ˆï¼š</p>
<pre><code class="language-bash">$ cargo build
    Updating registry `https://github.com/rust-lang/crates.io-index`
 Downloading rand v0.3.8
 Downloading libc v0.1.6
   Compiling libc v0.1.6
   Compiling rand v0.3.8
   Compiling guessing_game v0.1.0 (file:///home/you/projects/guessing_game)
</code></pre>
<p>ï¼ˆç•¶ç„¶ï¼Œä½ å¯èƒ½æœƒçœ‹åˆ°ä¸åŒç‰ˆæœ¬ã€‚ï¼‰</p>
<p>æœ‰å¾ˆå¤šæ–°çš„è¼¸å‡ºè³‡è¨Šï¼
ç¾åœ¨æˆ‘å€‘æœ‰äº†å¤–éƒ¨çš„ dependencyï¼ŒCargo æœƒå¾è¨»å†Šè¡¨å–å¾—æœ€æ–°ç‰ˆï¼Œé€™å€‹è¨»å†Šè¡¨æ˜¯ <a href="https://crates.io">Crates.io</a> çš„è¤‡æœ¬ã€‚
Crates.io æ˜¯ Rust ç”Ÿæ…‹ç³»ä¸­ï¼Œè®“äººå€‘ç™¼è¡¨ä»–å€‘çš„ Rust é–‹æ”¾åŸå§‹ç¢¼å°ˆæ¡ˆçµ¦å…¶ä»–äººä½¿ç”¨çš„åœ°æ–¹ã€‚</p>
<p>æ›´æ–°äº†è¨»å†Šè¡¨ä¹‹å¾Œï¼ŒCargo æœƒæª¢æŸ¥æˆ‘å€‘çš„ <code>[dependencies]</code> ç„¶å¾Œä¸‹è¼‰ä»»ä½•æˆ‘å€‘é‚„æ²’æœ‰çš„æ±è¥¿ã€‚
åœ¨é€™é‚Šçš„ä¾‹å­ï¼Œé›–ç„¶èªªæˆ‘å€‘åªèªªæƒ³è¦ç›¸ä¾ <code>rand</code>ï¼Œä½†æˆ‘å€‘ä»éœ€è¦å–å¾— <code>libc</code> çš„è¤‡æœ¬ã€‚
é€™æ˜¯å› ç‚º <code>rand</code> ç›¸ä¾æ–¼ <code>libc</code> æ‰èƒ½é‹ä½œã€‚
ä¸‹è¼‰å®ƒå€‘ä¹‹å¾Œï¼ŒCargo æœƒç·¨è­¯ä»–å€‘ï¼Œç„¶å¾Œç·¨è­¯æˆ‘å€‘çš„å°ˆæ¡ˆã€‚</p>
<p>å¦‚æœæˆ‘å€‘å†æ¬¡åŸ·è¡Œ <code>cargo build</code>ï¼Œæˆ‘å€‘å°‡æœƒçœ‹åˆ°ä¸åŒçš„è¼¸å‡ºçµæœï¼š</p>
<pre><code class="language-bash">$ cargo build
</code></pre>
<p>æ²’éŒ¯ï¼Œæ²’æœ‰è¼¸å‡ºï¼
Cargo çŸ¥é“æˆ‘å€‘çš„å°ˆæ¡ˆå·²ç¶“å»ºç½®å¥½äº†ï¼Œè€Œä¸”æ‰€æœ‰çš„ dependencies ä¹Ÿå»ºç½®å¥½äº†ï¼Œæ‰€ä»¥ä»–æ²’æœ‰ä»»ä½•ç†ç”±å†åšä¸€éã€‚
å› ç‚ºæ²’äº‹æƒ…åšï¼Œå®ƒå°±ç°¡å–®åœ°çµæŸäº†ã€‚
å¦‚æœæˆ‘å€‘å†æ¬¡é–‹å•Ÿ <code>src/main.rs</code>ï¼Œåšä¸€äº›ç°¡å–®çš„ä¿®æ”¹ï¼Œç„¶å¾Œå­˜æª”å†è©¦ä¸€æ¬¡ï¼Œæˆ‘å€‘åªæœƒçœ‹åˆ°ä¸€è¡Œï¼š</p>
<pre><code class="language-bash">$ cargo build
   Compiling guessing_game v0.1.0 (file:///home/you/projects/guessing_game)
</code></pre>
<p>æ‰€ä»¥ï¼Œæˆ‘å€‘å‘Šè¨´ Cargo æƒ³è¦ä»»ä½• <code>rand</code> çš„ <code>0.3.x</code> ç‰ˆï¼Œæ‰€ä»¥å®ƒæŠ“äº†ç•¶ä¸‹çš„æœ€æ–°ç‰ˆ <code>v0.3.8</code>ã€‚
ä½†å¦‚æœä¸‹é€±ï¼Œä¸€å€‹å¸¶æœ‰é‡è¦å•é¡Œä¿®æ­£çš„ <code>v0.3.9</code> ç‰ˆå‡ºç¾ä¹‹å¾Œæœƒç™¼ç”Ÿä»€éº¼äº‹æƒ…ï¼Ÿ
é›–ç„¶å–å¾—å•é¡Œçš„ä¿®æ­£å¾ˆé‡è¦ï¼Œä½†æ˜¯å¦‚æœ <code>0.3.9</code> åŒ…å«äº†æœƒå¼„å£æˆ‘å€‘ç¨‹å¼ç¢¼çš„ regression å‘¢ï¼Ÿ</p>
<p>é€™å€‹å•é¡Œçš„ç­”æ¡ˆæ˜¯åœ¨å°ˆæ¡ˆä¸­èƒ½æ‰¾åˆ°çš„ <code>Cargo.lock</code> æª”ã€‚
ç•¶ä½ ç¬¬ä¸€æ¬¡å»ºç½®å°ˆæ¡ˆæ™‚ï¼ŒCargo æœƒæª¢æŸ¥æ‰€æœ‰ç¬¦åˆä½ çš„æ¢ä»¶çš„ç‰ˆæœ¬ï¼Œç„¶å¾Œå¯«å…¥ <code>Cargo.lock</code> æª”ã€‚
æœªä¾†ç•¶ä½ å†æ¬¡å»ºç½®ä½ çš„å°ˆæ¡ˆæ™‚ï¼ŒCargo æœƒè¦– <code>Cargo.lock</code> æª”æ¡ˆæ˜¯å¦å·²ç¶“å­˜åœ¨ï¼Œç„¶å¾Œä½¿ç”¨è£¡é¢çš„ç‰¹å®šç‰ˆæœ¬ï¼Œè€Œéå†æ¬¡å°‹æ‰¾æ‰€æœ‰ç‰ˆæœ¬ã€‚
é€™è®“ä½ æœ‰ä¸€å€‹å¯ä»¥é‡è¤‡å»ºç½®çš„ç’°å¢ƒã€‚
ä¹Ÿå°±æ˜¯èªªï¼Œæˆ‘å€‘æœƒåœåœ¨ <code>0.3.8</code> ç›´åˆ°æˆ‘å€‘ç¢ºå®šè¦å‡ç´šï¼Œé€™ä¹Ÿå°ä»»ä½•æˆ‘å€‘èˆ‡ä¹‹åˆ†äº«ç¨‹å¼ç¢¼çš„äººæœ‰æ•ˆï¼Œæ„Ÿè¬ lock æª”ã€‚</p>
<p>ç•¶æˆ‘å€‘ <em>çœŸçš„</em> æƒ³è¦ç”¨ <code>0.3.9</code> æ™‚æ€éº¼è¾¦ï¼Ÿ
Cargo æœ‰å¦ä¸€å€‹æŒ‡ä»¤ <code>update</code>ï¼Œä»£è¡¨è‘— &quot;å¿½ç•¥ lock æª”ï¼Œå°‹æ‰¾æ‰€æœ‰ç¬¦åˆæˆ‘å€‘æŒ‡å®šæ¢ä»¶çš„æœ€æ–°ç‰ˆã€‚å¦‚æœé‹è¡ŒæˆåŠŸï¼ŒæŠŠé€™äº›ç‰ˆæœ¬å¯«å…¥ lock æª”&quot;ã€‚
ä½†æ˜¯ï¼Œé è¨­ Cargo åªæœƒå°‹æ‰¾å¤§æ–¼ <code>0.3.0</code> åŠå°æ–¼ <code>0.4.0</code> çš„ç‰ˆæœ¬ã€‚
å¦‚æœæˆ‘å€‘æƒ³è¦æ›åˆ° <code>0.4.x</code>ï¼Œæˆ‘å€‘å¿…é ˆç›´æ¥æ›´æ–° <code>Cargo.toml</code>ã€‚
ç•¶æˆ‘å€‘é€™æ¨£åšï¼Œä¸‹æ¬¡ <code>cargo build</code> æ™‚ï¼ŒCargo å°‡æœƒæ›´æ–°ç´¢å¼•ä¸¦é‡æ–°è©•ä¼° <code>rand</code> çš„éœ€æ±‚ã€‚</p>
<p>é—œæ–¼ <a href="http://doc.crates.io">Cargo</a> å’Œå…¶<a href="http://doc.crates.io/crates-io.html">ç”Ÿæ…‹ç³»</a>é‚„æœ‰å¾ˆå¤šå¯ä»¥èªªï¼Œä½†æ˜¯ç¾åœ¨ï¼Œé€™å°±æ˜¯æˆ‘å€‘æ‰€éœ€çŸ¥é“çš„å…¨éƒ¨äº†ã€‚
Cargo è®“é‡æ–°ä½¿ç”¨å‡½å¼åº«è®Šå¾—å¾ˆç°¡å–®ï¼Œè®“ Rustaceans æ˜“æ–¼å¯«å‡ºç”±è¨±å¤šå­å¥—ä»¶ (sub-packages) çµ„æˆçš„å°å°ˆæ¡ˆã€‚</p>
<p>æ¥è‘—è®“æˆ‘å€‘çœŸæ­£çš„ <em>ç”¨ç”¨çœ‹</em> <code>rand</code> å§ã€‚
é€™æ˜¯æˆ‘å€‘çš„ä¸‹ä¸€æ­¥ï¼š</p>
<pre><code class="language-rust,ignore">extern crate rand;

use std::io;
use rand::Rng;

fn main() {
    println!(&quot;Guess the number!&quot;);

    let secret_number = rand::thread_rng().gen_range(1, 101);

    println!(&quot;The secret number is: {}&quot;, secret_number);

    println!(&quot;Please input your guess.&quot;);

    let mut guess = String::new();

    io::stdin().read_line(&amp;mut guess)
        .expect(&quot;failed to read line&quot;);

    println!(&quot;You guessed: {}&quot;, guess);
}
</code></pre>
<p>ç¬¬ä¸€æ­¥æ˜¯ä¿®æ”¹ç¬¬ä¸€è¡Œã€‚
ç¾åœ¨ä»–æ˜¯ <code>extern crate rand</code>ã€‚
å› ç‚ºåœ¨ <code>[dependencies]</code> ä¸­æˆ‘å€‘å®£å‘Šäº† <code>rand</code>ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ <code>extern crate</code> è®“ Rust çŸ¥é“æˆ‘å€‘è¦ä½¿ç”¨å®ƒã€‚
é€™ä¹Ÿç­‰åŒæ–¼ <code>use rand;</code>ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥é€é <code>rand::</code> å‰ç¶´è©ä¾†ä½¿ç”¨ä»»ä½• <code>rand</code> crate å…§çš„æ±è¥¿ã€‚</p>
<p>æ¥è‘—ï¼Œæˆ‘å€‘åŠ å…¥å¦ä¸€è¡Œ <code>use</code>ï¼š<code>use rand::Rng</code>ã€‚
æˆ‘å€‘å³å°‡ä½¿ç”¨ä¸€å€‹æ–¹æ³• (method)ï¼Œé€™å€‹æ–¹æ³•éœ€è¦ <code>Rng</code> åœ¨æœ‰æ•ˆç¯„åœ (scope) ä¸­æ‰èƒ½é‹ä½œã€‚
åŸºæœ¬çš„æ¦‚å¿µæ˜¯ï¼šæ–¹æ³•è¢«å®šç¾©åœ¨æŸäº›è¢«ç¨±ç‚º &quot;traits&quot; çš„æ±è¥¿ä¸Šï¼Œtrait å¿…é ˆè¦åœ¨æœ‰æ•ˆç¯„åœä¸­ï¼Œæ–¹æ³•æ‰èƒ½é‹ä½œã€‚
æ›´å¤šç´°ç¯€å¯ä»¥é–±è®€ <a href="traits.html">traits</a> ä¸€ç¯€ã€‚</p>
<p>æˆ‘å€‘é‚„åŠ å…¥äº†å…¶ä»–å…©è¡Œåœ¨ä¸­é–“ï¼š</p>
<pre><code class="language-rust,ignore">    let secret_number = rand::thread_rng().gen_range(1, 101);

    println!(&quot;The secret number is: {}&quot;, secret_number);
</code></pre>
<p>æˆ‘å€‘ä½¿ç”¨ <code>rand::thread_rng()</code> å‡½å¼å»å–å¾—éš¨æ©Ÿæ•¸å­—ç”¢ç”Ÿå™¨çš„è¤‡æœ¬ï¼Œé€™å€‹è¤‡æœ¬ä½æ–¼æˆ‘å€‘æ­£åœ¨åŸ·è¡Œçš„ç‰¹å®š<a href="concurrency.html">åŸ·è¡Œç·’</a> (thread) ä¹‹ä¸Šã€‚
å› ç‚ºæˆ‘å€‘å‰é¢å·²ç¶“ <code>use rand::Rng</code>ï¼Œæ‰€ä»¥ <code>gen_rang()</code> æ–¹æ³•å¯ä»¥ä½¿ç”¨ã€‚
é€™å€‹æ–¹æ³•éœ€è¦å…©å€‹åƒæ•¸ï¼Œç„¶å¾Œç”¢ç”Ÿä¸€å€‹åœ¨å…©å€‹åƒæ•¸ä¹‹é–“çš„æ•¸å­—ã€‚
åŒ…å«äº†ä¸‹é™å€¼ï¼Œä½†ä¸åŒ…å«ä¸Šé™å€¼ï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦ <code>1</code> å’Œ <code>101</code> å»å–å¾— 1 åˆ° 100 ç¯„åœå…§çš„æ•¸å­—ã€‚</p>
<p>ç¬¬äºŒè¡Œå°å‡ºç¥•å¯†æ•¸å­—ã€‚
ç•¶æˆ‘å€‘æ­£åœ¨é–‹ç™¼ç¨‹å¼æ™‚é€™å¾ˆæœ‰ç”¨ï¼Œè®“æˆ‘å€‘å¯ä»¥ç°¡å–®çš„æ¸¬è©¦ä¸€ä¸‹ã€‚
ä¸éæˆ‘å€‘åœ¨æœ€å¾Œæœƒåˆªæ‰å®ƒã€‚
æ²’ä»€éº¼éŠæˆ²æœƒåœ¨ä¸€é–‹å§‹å°±å°å‡ºç­”æ¡ˆçš„ï¼</p>
<p>è©¦è‘—åŸ·è¡Œæˆ‘å€‘çš„æ–°ç¨‹å¼å¹¾æ¬¡ï¼š</p>
<pre><code class="language-bash">$ cargo run
   Compiling guessing_game v0.1.0 (file:///home/you/projects/guessing_game)
     Running `target/debug/guessing_game`
Guess the number!
The secret number is: 7
Please input your guess.
4
You guessed: 4
$ cargo run
     Running `target/debug/guessing_game`
Guess the number!
The secret number is: 83
Please input your guess.
5
You guessed: 5
</code></pre>
<p>å¤ªæ£’äº†ï¼
æ¥è‘—ï¼šå°±è¦é–‹å§‹æ¯”è¼ƒæˆ‘å€‘çš„çŒœæ¸¬å€¼å’Œç¥•å¯†æ•¸å­—ã€‚</p>
<h2>æ¯”è¼ƒçŒœæ¸¬å€¼</h2>
<p>ç¾åœ¨ï¼Œæˆ‘å€‘æ‹¿åˆ°äº†ä½¿ç”¨è€…çš„è¼¸å…¥å€¼ï¼Œè®“æˆ‘å€‘ä¾†æ¯”è¼ƒçŒœæ¸¬å€¼å’Œç¥•å¯†æ•¸å­—ã€‚
ä»¥ä¸‹æ˜¯æˆ‘å€‘çš„ä¸‹ä¸€æ­¥ï¼Œé›–ç„¶é€™é‚„æ²’ç·¨è­¯éï¼š</p>
<pre><code class="language-rust,ignore">extern crate rand;

use std::io;
use std::cmp::Ordering;
use rand::Rng;

fn main() {
    println!(&quot;Guess the number!&quot;);

    let secret_number = rand::thread_rng().gen_range(1, 101);

    println!(&quot;The secret number is: {}&quot;, secret_number);

    println!(&quot;Please input your guess.&quot;);

    let mut guess = String::new();

    io::stdin().read_line(&amp;mut guess)
        .expect(&quot;failed to read line&quot;);

    println!(&quot;You guessed: {}&quot;, guess);

    match guess.cmp(&amp;secret_number) {
        Ordering::Less    =&gt; println!(&quot;Too small!&quot;),
        Ordering::Greater =&gt; println!(&quot;Too big!&quot;),
        Ordering::Equal   =&gt; println!(&quot;You win!&quot;),
    }
}
</code></pre>
<p>é€™è£¡æœ‰äº›æ–°æ±è¥¿ã€‚
é¦–å…ˆæ˜¯å¦ä¸€å€‹ <code>use</code>ã€‚
æˆ‘å€‘ç”¨äº†ç¨±ç‚º <code>std::cmp::Ordering</code> çš„å‹åˆ¥åˆ°æœ‰æ•ˆç¯„åœä¸­ã€‚
ç„¶å¾Œåº•ä¸‹æœ‰äº”è¡Œç¨‹å¼ç¢¼ç”¨åˆ°å®ƒï¼š</p>
<pre><code class="language-rust,ignore">match guess.cmp(&amp;secret_number) {
    Ordering::Less    =&gt; println!(&quot;Too small!&quot;),
    Ordering::Greater =&gt; println!(&quot;Too big!&quot;),
    Ordering::Equal   =&gt; println!(&quot;You win!&quot;),
}
</code></pre>
<p><code>cmp()</code> æ–¹æ³•å¯ä»¥è¢«ä»»ä½•èƒ½ç”¨ä¾†æ¯”è¼ƒçš„æ±è¥¿å‘¼å«ï¼Œä¸”å®ƒæœƒè¦æ±‚å‚³å…¥ä½ æƒ³æ¯”è¼ƒçš„æ±è¥¿çš„åƒç…§ã€‚
å®ƒå›å‚³æˆ‘å€‘å‰é¢ <code>use</code> çš„ <code>Ordering</code> å‹åˆ¥ã€‚
æˆ‘å€‘ä½¿ç”¨ <a href="match.html">match</a> é™³è¿°å»åˆ¤å®šå®ƒå¯¦éš›ä¸Šæ˜¯å“ªç¨® <code>Ordering</code>ã€‚
<code>Ordering</code> æ˜¯å€‹ <a href="enums.html">enum</a>ï¼Œæšèˆ‰ (enumeration) çš„ç°¡å¯«ï¼Œçœ‹èµ·ä¾†æœƒæœ‰é»åƒé€™æ¨£ï¼š</p>
<pre><code class="language-rust">enum Foo {
    Bar,
    Baz,
}
</code></pre>
<p>é€™è£¡å®šç¾©äº†ä»»ä½• <code>Foo</code> ä¸æ˜¯ <code>Foo::Bar</code> å°±æ˜¯ <code>Foo::Baz</code>ã€‚
æˆ‘å€‘ä½¿ç”¨ <code>::</code> ä¾†è¡¨ç¤ºç‰¹å®š <code>enum</code> è®Šé«”çš„å‘½åç©ºé–“ (namespace)ã€‚</p>
<p><a href="https://doc.rust-lang.org/std/cmp/enum.Ordering.html">Ordering</a> <code>enum</code> æœ‰ä¸‰å€‹å¯èƒ½çš„è®Šé«”ï¼š<code>Less</code>ã€<code>Equal</code>ã€åŠ <code>Greater</code>ã€‚
<code>match</code> é™³è¿°å¼å–å¾—å‹åˆ¥çš„å€¼ï¼Œè®“ä½ èƒ½ç‚ºæ¯å€‹å¯èƒ½çš„å€¼å»ºç«‹ä¸€æ¢åŸ·è¡Œçš„åˆ†æ”¯ã€‚
å› ç‚º <code>Ordering</code> æœ‰ä¸‰ç¨®å‹åˆ¥ï¼Œæˆ‘å€‘å°±æœ‰ä¸‰å€‹åˆ†æ”¯ï¼š</p>
<pre><code class="language-rust,ignore">match guess.cmp(&amp;secret_number) {
    Ordering::Less    =&gt; println!(&quot;Too small!&quot;),
    Ordering::Greater =&gt; println!(&quot;Too big!&quot;),
    Ordering::Equal   =&gt; println!(&quot;You win!&quot;),
}
</code></pre>
<p>å¦‚æœå®ƒæ˜¯ <code>Less</code>ï¼Œæˆ‘å€‘å°å‡º <code>Too small!</code>ï¼Œå¦‚æœæ˜¯ <code>Greater</code> å‰‡å°å‡º <code>Too big!</code>ï¼Œå¦‚æœæ˜¯ <code>Equal</code> å°±å°å‡º <code>You win!</code>ã€‚
<code>match</code> éå¸¸æœ‰ç”¨ï¼Œè€Œä¸”åœ¨ Rust ä¸­å¸¸æœƒç”¨åˆ°ã€‚</p>
<p>é›–ç„¶æˆ‘ç¢ºå¯¦æåˆ°éæˆ‘å€‘é‚„ä¸èƒ½ç·¨è­¯æˆåŠŸã€‚
è®“æˆ‘å€‘é‚„æ˜¯è©¦è©¦çœ‹ï¼š</p>
<pre><code class="language-bash">$ cargo build
   Compiling guessing_game v0.1.0 (file:///home/you/projects/guessing_game)
src/main.rs:28:21: 28:35 error: mismatched types:
 expected `&amp;collections::string::String`,
    found `&amp;_`
(expected struct `collections::string::String`,
    found integral variable) [E0308]
src/main.rs:28     match guess.cmp(&amp;secret_number) {
                                   ^~~~~~~~~~~~~~
error: aborting due to previous error
Could not compile `guessing_game`.
</code></pre>
<p>å™¢ï¼é€™è£¡æœ‰å€‹å¤§å•é¡Œã€‚
å®ƒçš„æ ¸å¿ƒå•é¡Œæ˜¯æˆ‘å€‘æœ‰ &quot;ç„¡æ³•åŒ¹é…çš„å‹åˆ¥&quot; (mismatched types)ã€‚
Rust æœ‰å€‹å¼·å¤§çš„éœæ…‹å‹åˆ¥ç³»çµ± (static type system)ã€‚
ä½†æ˜¯ï¼Œå®ƒä¹Ÿæœ‰å‹åˆ¥æ¨æ–· (type inference) ç³»çµ±ã€‚
ç•¶æˆ‘å€‘å¯«åˆ° <code>let guess = String::new()</code> æ™‚ï¼ŒRust æœƒæ¨æ–· <code>guess</code> æ‡‰è©²æ˜¯ <code>String</code>ï¼Œå› æ­¤ä¸éœ€è¦æˆ‘å€‘ç‰¹åˆ¥å¯«å‡ºå‹åˆ¥ã€‚
è€Œæˆ‘å€‘çš„ <code>secret_number</code> å‰‡æœ‰å¤šç¨®å¯èƒ½çš„å‹åˆ¥éƒ½å¯ä»¥å­˜ 1 åˆ° 100 çš„å€¼ï¼š32 ä½å…ƒæ•´æ•¸ <code>i32</code>ã€éå¸¶è™Ÿ (unsigned) 32 ä½å…ƒæ•´æ•¸ <code>u32</code>ã€64 ä½å…ƒæ•´æ•¸ <code>i64</code> æˆ–å…¶ä»–ç­‰ç­‰ã€‚
ç›®å‰é€™äº›éƒ½ä¸é‡è¦ï¼Œæ‰€ä»¥ Rust é è¨­ç‚º <code>i32</code>ã€‚
ç„¶è€Œï¼ŒRust ä¸çŸ¥é“æ€éº¼å»æ¯”å° <code>guess</code> èˆ‡ <code>secret_number</code>ã€‚
å®ƒå€‘å¿…é ˆæ˜¯ç›¸åŒå‹åˆ¥ã€‚
æœ€çµ‚ï¼Œç‚ºäº†å¯ä»¥æ¯”è¼ƒï¼Œæˆ‘å€‘æƒ³è¦æŠŠè¼¸å…¥çš„ <code>String</code> è½‰æ›ç‚ºä¸€å€‹çœŸæ­£çš„æ•¸å­—å‹åˆ¥ã€‚
æˆ‘å€‘å¯ä»¥ç”¨é¡å¤–çš„å…©è¡Œåšåˆ°ã€‚
ä»¥ä¸‹æ˜¯æˆ‘å€‘çš„æ–°ç¨‹å¼ï¼š</p>
<pre><code class="language-rust,ignore">extern crate rand;

use std::io;
use std::cmp::Ordering;
use rand::Rng;

fn main() {
    println!(&quot;Guess the number!&quot;);

    let secret_number = rand::thread_rng().gen_range(1, 101);

    println!(&quot;The secret number is: {}&quot;, secret_number);

    println!(&quot;Please input your guess.&quot;);

    let mut guess = String::new();

    io::stdin().read_line(&amp;mut guess)
        .expect(&quot;failed to read line&quot;);

    let guess: u32 = guess.trim().parse()
        .expect(&quot;Please type a number!&quot;);

    println!(&quot;You guessed: {}&quot;, guess);

    match guess.cmp(&amp;secret_number) {
        Ordering::Less    =&gt; println!(&quot;Too small!&quot;),
        Ordering::Greater =&gt; println!(&quot;Too big!&quot;),
        Ordering::Equal   =&gt; println!(&quot;You win!&quot;),
    }
}
</code></pre>
<p>æ–°åŠ çš„å…©è¡Œï¼š</p>
<pre><code class="language-rust,ignore">    let guess: u32 = guess.trim().parse()
        .expect(&quot;Please type a number!&quot;);
</code></pre>
<p>ç­‰ç­‰ï¼Œæˆ‘æƒ³æˆ‘å€‘å·²ç¶“æœ‰ <code>guess</code> äº†å§ï¼Ÿ
æ²’éŒ¯ï¼Œä½†æ˜¯ Rust å…è¨±æˆ‘å€‘ç”¨æ–°çš„ <code>guess</code> å» &quot;é®è”½&quot; (shadow) å‰ä¸€å€‹ã€‚
ä¸€é–‹å§‹ <code>guess</code> æ˜¯ <code>String</code>ï¼Œä½†æˆ‘å€‘å¸Œæœ›èƒ½è½‰æ›ç‚º <code>u32</code>ï¼Œåƒæ˜¯é€™æ¨£çš„æƒ…æ³ä¸‹æˆ‘å€‘å¾ˆå¸¸æœƒç”¨åˆ°ã€‚
é®è”½è®“æˆ‘å€‘å¯ä»¥é‡è¤‡åˆ©ç”¨ <code>guess</code> çš„å‘½åï¼Œè€Œéå¼·è¿«æˆ‘å€‘å»æƒ³å‡ºå…©å€‹ç¨ç‰¹çš„å‘½åï¼Œåƒæ˜¯ <code>guess_str</code> å’Œ <code>guess</code>ï¼Œæˆ–å…¶ä»–çš„åç¨±ã€‚</p>
<p>æˆ‘å€‘æŠŠ <code>guess</code> ç¶å®šåœ¨æˆ‘å€‘å‰é¢æ‰€å¯«çš„è¡¨é”å¼ä¸Šï¼š</p>
<pre><code class="language-rust,ignore">guess.trim().parse()
</code></pre>
<p>é€™é‚Šçš„ <code>guess</code> åƒè€ƒåˆ°å­˜è‘—æˆ‘å€‘è¼¸å…¥å€¼çš„èˆŠçš„ <code>guess</code>ã€‚
è€Œ <code>String</code> ä¸­çš„ <code>trim()</code> æ–¹æ³•å‰‡æœƒå»é™¤ä»»ä½•å­—ä¸²é–‹é ­çµå°¾çš„ç©ºç™½ã€‚
é€™å¾ˆé‡è¦ï¼Œå› ç‚ºæˆ‘å€‘å¿…é ˆæŒ‰ä¸‹ &quot;Return&quot; æŒ‰éµå»ç¬¦åˆ <code>read_line()</code> çš„è¼¸å…¥æ¢ä»¶ã€‚
ä¹Ÿå°±æ˜¯èªªå¦‚æœæˆ‘å€‘è¼¸å…¥ <code>5</code> ç„¶å¾ŒæŒ‰ä¸‹ Returnï¼Œé‚£ <code>guess</code> çœ‹èµ·ä¾†å°±æœƒåƒæ˜¯ï¼š<code>5\n</code>ã€‚
<code>\n</code> ä»£è¡¨ &quot;æ–°çš„ä¸€è¡Œ&quot; (newline)ã€enter éµã€‚
<code>trim()</code> æœƒå»é™¤é€™äº›ï¼Œåªç•™ä¸‹æˆ‘å€‘çš„å­—ä¸² <code>5</code>ã€‚
è€Œ<a href="https://doc.rust-lang.org/std/primitive.str.html#method.parse">å­—ä¸²çš„ parse() æ–¹æ³•</a>å‰‡æœƒæŠŠå­—ä¸²åˆ†æç‚ºæ•¸å­—ã€‚
å› ç‚ºå®ƒå¯ä»¥è¢«åˆ†æç‚ºå¾ˆå¤šç¨®æ•¸å­—å‹åˆ¥ï¼Œæˆ‘å€‘å¿…é ˆçµ¦ Rust æˆ‘å€‘ç¢ºåˆ‡æƒ³è¦çš„æ•¸å­—å‹åˆ¥çš„æç¤ºã€‚
å› æ¬¡æˆ‘å€‘çµ¦å®ƒ <code>let guess: u32</code>ã€‚
<code>guess</code> å¾Œé¢çš„åˆ†è™Ÿï¼ˆ<code>:</code>ï¼‰å‘Šè¨´ Rust æˆ‘å€‘è¦è¨»é‡‹å®ƒçš„å‹åˆ¥ã€‚
<code>u32</code> æ˜¯æ²’æœ‰å¸¶æ­£è² è™Ÿçš„ 32 ä½å…ƒæ•´æ•¸ã€‚
Rust æœ‰<a href="primitive-types.html#%E6%95%B8%E5%AD%97%E5%9E%8B%E5%88%A5">è¨±å¤šå…§å»ºçš„æ•¸å­—å‹åˆ¥</a>ï¼Œæˆ‘å€‘é¸äº† <code>u32</code>ã€‚
å°æ–¼ä¸å¤§çš„æ­£æ•´æ•¸ä¾†èªªï¼Œå®ƒæ˜¯å€‹å¥½é¸æ“‡ã€‚</p>
<p>è·Ÿ <code>read_line()</code> ä¸€æ¨£ï¼Œæˆ‘å€‘å‘¼å« <code>parse()</code> æ™‚å¯èƒ½æœƒç™¼ç”ŸéŒ¯èª¤ã€‚
å¦‚æœæˆ‘å€‘çš„å­—ä¸²åŒ…å«äº† <code>AğŸ‘%</code> æ€éº¼è¾¦ï¼Ÿ
æˆ‘å€‘å¯ç„¡æ³•æŠŠå®ƒè½‰æ›ç‚ºæ•¸å­—ã€‚
ç‚ºæ­¤æˆ‘å€‘åšäº†èˆ‡ä¹‹å‰æ›¿ <code>read_line()</code> æ‰€åšçš„äº‹ä¸€æ¨£çš„äº‹ï¼šä½¿ç”¨ <code>expect()</code> æ–¹æ³•ï¼Œè®“å®ƒå‡ºéŒ¯æ™‚ç•¶æ©Ÿã€‚</p>
<p>è®“æˆ‘å€‘è©¦è©¦æˆ‘å€‘çš„ç¨‹å¼ï¼</p>
<pre><code class="language-bash">$ cargo run
   Compiling guessing_game v0.1.0 (file:///home/you/projects/guessing_game)
     Running `target/guessing_game`
Guess the number!
The secret number is: 58
Please input your guess.
  76
You guessed: 76
Too big!
</code></pre>
<p>ä¸éŒ¯ï¼
ä½ å¯ä»¥çœ‹åˆ°æˆ‘åœ¨çŒœæ¸¬å€¼å‰é¢åŠ å…¥ç©ºç™½ï¼Œå®ƒä»å¯ä»¥èªå‡ºæˆ‘çŒœçš„æ˜¯ 76ã€‚
å¤šåŸ·è¡Œç¨‹å¼å¹¾æ¬¡ï¼Œç„¶å¾Œé©—è­‰çœ‹çœ‹çŒœä¸­æ­£ç¢ºçš„æ•¸å­—ï¼Œå’ŒçŒœä¸€å€‹æ¯”è¼ƒå°çš„æ•¸å­—ã€‚</p>
<p>ç¾åœ¨æˆ‘å€‘çš„éŠæˆ²å¤§è‡´ä¸Šèƒ½é‹ä½œäº†ï¼Œä½†æ˜¯æˆ‘å€‘åªèƒ½çŒœä¸€æ¬¡ã€‚
è®“æˆ‘å€‘åŠ å…¥è¿´åœˆ (loops) ä¾†ä¿®æ”¹å®ƒã€‚</p>
<h2>è¿´åœˆ</h2>
<p>é—œéµå­— <code>loop</code> æœƒçµ¦æˆ‘å€‘ä¸€å€‹ç„¡é™è¿´åœˆã€‚
è®“æˆ‘å€‘åŠ ä¸Šå®ƒï¼š</p>
<pre><code class="language-rust,ignore">extern crate rand;

use std::io;
use std::cmp::Ordering;
use rand::Rng;

fn main() {
    println!(&quot;Guess the number!&quot;);

    let secret_number = rand::thread_rng().gen_range(1, 101);

    println!(&quot;The secret number is: {}&quot;, secret_number);

    loop {
        println!(&quot;Please input your guess.&quot;);

        let mut guess = String::new();

        io::stdin().read_line(&amp;mut guess)
            .expect(&quot;failed to read line&quot;);

        let guess: u32 = guess.trim().parse()
            .expect(&quot;Please type a number!&quot;);

        println!(&quot;You guessed: {}&quot;, guess);

        match guess.cmp(&amp;secret_number) {
            Ordering::Less    =&gt; println!(&quot;Too small!&quot;),
            Ordering::Greater =&gt; println!(&quot;Too big!&quot;),
            Ordering::Equal   =&gt; println!(&quot;You win!&quot;),
        }
    }
}
</code></pre>
<p>ç„¶å¾Œè©¦è©¦çœ‹ã€‚
ç­‰ç­‰ï¼Œæˆ‘å€‘ä¸æ˜¯åŠ äº†å€‹ç„¡é™è¿´åœˆå—ï¼Ÿ
æ²’éŒ¯ï¼Œé‚„è¨˜å¾—æˆ‘å€‘è¨è«–éçš„ <code>parse()</code> å—ï¼Ÿ
å¦‚æœæˆ‘å€‘è¼¸å…¥ä¸€å€‹ä¸æ˜¯æ•¸å­—çš„ç­”æ¡ˆï¼Œæˆ‘å€‘å°±æœƒ <code>panic!</code> ç„¶å¾ŒçµæŸã€‚
çœ‹è‘—ï¼š</p>
<pre><code class="language-bash">$ cargo run
   Compiling guessing_game v0.1.0 (file:///home/you/projects/guessing_game)
     Running `target/guessing_game`
Guess the number!
The secret number is: 59
Please input your guess.
45
You guessed: 45
Too small!
Please input your guess.
60
You guessed: 60
Too big!
Please input your guess.
59
You guessed: 59
You win!
Please input your guess.
quit
thread '&lt;main&gt;' panicked at 'Please type a number!'
</code></pre>
<p>å“ˆï¼
<code>quit</code> çœŸçš„é€€å‡ºäº†ã€‚
å°±è·Ÿä»»ä½•å…¶ä»–ä¸æ˜¯æ•¸å­—çš„è¼¸å…¥ä¸€æ¨£ã€‚
å¥½å§ï¼Œé€™è‡³å°‘æ˜¯å€‹é‚„å¯ä»¥çš„åšæ³•ã€‚
æ¥è‘—ï¼Œè®“æˆ‘å€‘èƒ½åœ¨è´äº†éŠæˆ²çš„æ™‚å€™çœŸçš„é€€å‡ºï¼š</p>
<pre><code class="language-rust,ignore">extern crate rand;

use std::io;
use std::cmp::Ordering;
use rand::Rng;

fn main() {
    println!(&quot;Guess the number!&quot;);

    let secret_number = rand::thread_rng().gen_range(1, 101);

    println!(&quot;The secret number is: {}&quot;, secret_number);

    loop {
        println!(&quot;Please input your guess.&quot;);

        let mut guess = String::new();

        io::stdin().read_line(&amp;mut guess)
            .expect(&quot;failed to read line&quot;);

        let guess: u32 = guess.trim().parse()
            .expect(&quot;Please type a number!&quot;);

        println!(&quot;You guessed: {}&quot;, guess);

        match guess.cmp(&amp;secret_number) {
            Ordering::Less    =&gt; println!(&quot;Too small!&quot;),
            Ordering::Greater =&gt; println!(&quot;Too big!&quot;),
            Ordering::Equal   =&gt; {
                println!(&quot;You win!&quot;);
                break;
            }
        }
    }
}
</code></pre>
<p>é€éåœ¨ <code>You win!</code> ä¹‹å¾ŒåŠ å…¥ <code>break</code>ï¼Œæˆ‘å€‘å¯ä»¥åœ¨è´äº†ä¹‹å¾Œé›¢é–‹è¿´åœˆã€‚
å› ç‚ºå®ƒåŒæ™‚æ˜¯ <code>main()</code> çš„æœ€å¾Œä¸€éƒ¨ä»½ï¼Œæ‰€ä»¥é›¢é–‹è¿´åœˆä¹Ÿä»£è¡¨è‘—é€€å‡ºç¨‹å¼ã€‚
æˆ‘å€‘å‰©ä¸‹æœ€å¾Œä¸€é»éœ€è¦ä¿®æ”¹ï¼šç•¶è¼¸å…¥ä¸€å€‹ä¸æ˜¯æ•¸å­—çš„è¼¸å…¥ï¼Œæˆ‘å€‘ä¸æƒ³é€€å‡ºç¨‹å¼ï¼Œæˆ‘å€‘è¦å¿½ç•¥å®ƒã€‚
æˆ‘å€‘å¯ä»¥åƒä»¥ä¸‹é€™æ¨£åšï¼š</p>
<pre><code class="language-rust,ignore">extern crate rand;

use std::io;
use std::cmp::Ordering;
use rand::Rng;

fn main() {
    println!(&quot;Guess the number!&quot;);

    let secret_number = rand::thread_rng().gen_range(1, 101);

    println!(&quot;The secret number is: {}&quot;, secret_number);

    loop {
        println!(&quot;Please input your guess.&quot;);

        let mut guess = String::new();

        io::stdin().read_line(&amp;mut guess)
            .expect(&quot;failed to read line&quot;);

        let guess: u32 = match guess.trim().parse() {
            Ok(num) =&gt; num,
            Err(_) =&gt; continue,
        };

        println!(&quot;You guessed: {}&quot;, guess);

        match guess.cmp(&amp;secret_number) {
            Ordering::Less    =&gt; println!(&quot;Too small!&quot;),
            Ordering::Greater =&gt; println!(&quot;Too big!&quot;),
            Ordering::Equal   =&gt; {
                println!(&quot;You win!&quot;);
                break;
            }
        }
    }
}
</code></pre>
<p>é€™æ˜¯æˆ‘å€‘æ‰€ä¿®æ”¹çš„éƒ¨åˆ†ï¼š</p>
<pre><code class="language-rust,ignore">let guess: u32 = match guess.trim().parse() {
    Ok(num) =&gt; num,
    Err(_) =&gt; continue,
};
</code></pre>
<p>æŠŠ <code>expect()</code> æ”¹ç‚º <code>match</code> é™³è¿°çš„æ–¹å¼ï¼Œå¤§è‡´ä¸Šå°±æ˜¯å¦‚ä½•æŠŠ &quot;éŒ¯èª¤æ™‚ç•¶æ©Ÿ&quot; æ”¹ç‚º &quot;å¯¦éš›è™•ç†éŒ¯èª¤&quot; çš„æ–¹æ³•ã€‚
<code>parse()</code> å›å‚³çš„ <code>Result</code> æ˜¯å€‹è·Ÿ <code>Ordering</code> é¡ä¼¼çš„ <code>enum</code>ï¼Œä½†æ˜¯é€™è£¡çš„è®Šé«”è·Ÿè³‡æ–™æœ‰é—œï¼š<code>Ok</code> ä»£è¡¨æˆåŠŸï¼Œ<code>Err</code> å‰‡æ˜¯éŒ¯èª¤ã€‚
å®ƒå€‘å€‹åˆ¥åŒ…å«æ›´å¤šçš„è³‡è¨Šï¼šæˆåŠŸçš„åˆ†æå‡ºæ•´æ•¸ï¼Œæˆ–æ˜¯ä¸€å€‹éŒ¯èª¤å‹åˆ¥ã€‚
åœ¨æœ¬ä¾‹ä¸­ï¼Œç•¶æˆ‘å€‘ <code>match</code> åˆ° <code>Ok(num)</code> æ™‚ï¼ŒæœƒæŠŠ <code>Ok</code> å…§çš„å€¼è¨­çµ¦ <code>num</code> é€™å€‹åç¨±ï¼Œç„¶å¾Œåœ¨å³é‚Šå›å‚³å®ƒã€‚
åœ¨ <code>Err</code> çš„æƒ…æ³ï¼Œæˆ‘å€‘ä¸åœ¨æ„ç™¼ç”Ÿäº†ä»€éº¼éŒ¯èª¤ï¼Œæ‰€ä»¥æˆ‘å€‘ä½¿ç”¨ <code>_</code> æ²’æœ‰å–åã€‚
é€™æ¨£æœƒå¿½ç•¥éŒ¯èª¤ï¼Œæ¥è‘— <code>continue</code> è®“æˆ‘å€‘å¯ä»¥ç¹¼çºŒ <code>loop</code> çš„ä¸‹ä¸€æ¬¡ç–Šä»£ (iteration)ã€‚</p>
<p>ç¾åœ¨æ‡‰è©²å¼„å¥½äº†ï¼
è®“æˆ‘å€‘è©¦è©¦çœ‹ï¼š</p>
<pre><code class="language-bash">$ cargo run
   Compiling guessing_game v0.1.0 (file:///home/you/projects/guessing_game)
     Running `target/guessing_game`
Guess the number!
The secret number is: 61
Please input your guess.
10
You guessed: 10
Too small!
Please input your guess.
99
You guessed: 99
Too big!
Please input your guess.
foo
Please input your guess.
61
You guessed: 61
You win!
</code></pre>
<p>å¤ªæ£’äº†ï¼
å‰©ä¸‹æœ€å¾Œä¸€å€‹å°ä¿®æ”¹ï¼Œæˆ‘å€‘å°±å®Œæˆäº†çŒœæ•¸å­—éŠæˆ²ã€‚
ä½ èƒ½çŒœåˆ°æ˜¯ä»€éº¼å—ï¼Ÿ
æ²’éŒ¯ï¼Œæˆ‘å€‘ä¸å¸Œæœ›å°å‡ºç¥•å¯†æ•¸å­—ã€‚
åœ¨æ¸¬è©¦æ™‚å®ƒå¾ˆå¥½ï¼Œä½†æ˜¯å®ƒæœƒæ¯€æ‰éŠæˆ²ã€‚
é€™æ˜¯æˆ‘å€‘æœ€çµ‚çš„ç¨‹å¼ç¢¼ï¼š</p>
<pre><code class="language-rust,ignore">extern crate rand;

use std::io;
use std::cmp::Ordering;
use rand::Rng;

fn main() {
    println!(&quot;Guess the number!&quot;);

    let secret_number = rand::thread_rng().gen_range(1, 101);

    loop {
        println!(&quot;Please input your guess.&quot;);

        let mut guess = String::new();

        io::stdin().read_line(&amp;mut guess)
            .expect(&quot;failed to read line&quot;);

        let guess: u32 = match guess.trim().parse() {
            Ok(num) =&gt; num,
            Err(_) =&gt; continue,
        };

        println!(&quot;You guessed: {}&quot;, guess);

        match guess.cmp(&amp;secret_number) {
            Ordering::Less    =&gt; println!(&quot;Too small!&quot;),
            Ordering::Greater =&gt; println!(&quot;Too big!&quot;),
            Ordering::Equal   =&gt; {
                println!(&quot;You win!&quot;);
                break;
            }
        }
    }
}
</code></pre>
<h2>å®Œæˆï¼</h2>
<p>æ­¤æ™‚æ­¤åˆ»ï¼Œä½ æˆåŠŸçš„å»ºç½®äº†çŒœè¬éŠæˆ²ï¼
æ­å–œä½ ï¼</p>
<p>é€™ç¬¬ä¸€å€‹å°ˆæ¡ˆå‘Šè¨´ä½ ä¸å°‘æ±è¥¿ï¼š<code>let</code>ã€<code>match</code>ã€æ–¹æ³• (methods)ã€é—œè¯å‡½å¼ (associated functions)ã€ä½¿ç”¨å¤–éƒ¨çš„ cratesã€ç­‰ç­‰ã€‚
æˆ‘å€‘çš„ä¸‹å€‹å°ˆæ¡ˆæœƒå‘Šè¨´ä½ æ›´å¤šæ±è¥¿ã€‚</p>
<blockquote>
<p>è­¯è¨»ï¼šå¯¦ä½œ <code>dining-philosophers</code> å°ˆæ¡ˆçš„ç« ç¯€å·²ç¶“è¢«ç§»é™¤äº†ï¼Œæ‰€ä»¥å¾ŒçºŒæœƒæ¥åˆ°èªæ³•çš„éƒ¨åˆ†ã€‚</p>
</blockquote>
<blockquote>
<p><em>commit edd5f33</em></p>
</blockquote>

                </div>

                <!-- Mobile navigation buttons -->
                
                    <a href="getting-started.html" class="mobile-nav-chapters previous">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="syntax-and-semantics.html" class="mobile-nav-chapters next">
                        <i class="fa fa-angle-right"></i>
                    </a>
                

            </div>

            
                <a href="getting-started.html" class="nav-chapters previous" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-left"></i>
                </a>
            

            
                <a href="syntax-and-semantics.html" class="nav-chapters next" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-right"></i>
                </a>
            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <script src="highlight.js"></script>
        <script src="book.js"></script>
    </body>
</html>
